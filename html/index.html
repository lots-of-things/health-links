<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<meta charset="utf-8">
		<title>Health Connect</title>
		<meta name="generator" content="Bootply" />
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
        <link href="css/social-buttons.css" rel="stylesheet">

		<link href="css/styles.css" rel="stylesheet">
	    <link href="css/demo.css" rel="stylesheet">
	</head>
	<body>
<div class="wrapper">
    <div class="box">
        <div class="row">



            <!-- main -->
            <div class="column col-sm-12" id="main">
                <div class="padding">
                    <div class="full col-sm-12">

                        <!-- content -->


                        <div class="row">
                          <div class="col-sm-12"><a href="http://www.makeloft.org/" target="_blank" class="btn btn-default navbar-btn" style="float:right;background:#E2A675;color:white">by MakeLofT</a>
                            <h3>Connectivity of </h3>
                            <p>Mockup of the force graph part of the app</p>
                          </div>

                        </div>

                         </div>
                        <div class="row divider">
                           <div class="col-sm-12"><hr></div>
                        </div>

                        <div class="row">
                          <div class="col-sm-8">
                            <h4><strong>Connectivity of Dermatology</strong></h4>
                            <p>click to expand; hover for description; drag around for fun</p>
                          </div>
                          <div class="col-sm-4">
                          <h4><span class="label label-default"><a href="http://bl.ocks.org/mbostock/1062288" target="_blank">Force Plot</a></span></h4><h4>
                            <small id="interestDiv" class="text-muted2"  > This graph illustrates the connections between my interests in computing, biomaterials, sustainability, and public outreach.

                            </small>
                            <small class="text-muted"><a id="interestBut" class="text-muted" onclick="showInterestDiv()">Read More</a></small>
                            </h4>
                          </div>
                        </div>

                        <div class="row">
                          <div class="col-sm-12" id="forcegraph">

                          </div>

                        </div>

                        <div class="row divider">
                           <div class="col-sm-12"><hr></div>
                        </div>




                        <div class="row divider">
                           <div class="col-sm-12"><hr></div>
                        </div>



                        <hr>
                        <hr>
                        <p class="text-center">Extreme thanks and mad props to <a href="http://bost.ocks.org/mike/">Mike Bostock</a> of <a href="http://d3js.org/">D3</a> for the visualization tools.
                            </p>
                        <hr>
                        <hr>
                        <div class="row" id="footer">

                          <div class="col-sm-12">
                            <p class="text-right">
                            Content under Creative Commons <a href='http://creativecommons.org/licenses/by-nc-sa/4.0/'>BY-NC-SA. </a>Powered by  <a href='https://developers.google.com/appengine/'>GAE.</a> Bootstrap layout adapted from <a href="http://bootply.com/" target="ext">Bootply.</a> <br>Uses <a href="http://fortawesome.github.io/Font-Awesome/">Font-Awesome</a> and <a href="https://github.com/noizwaves/bootstrap-social-buttons">bootstrap-social-buttons</a>. For best results, try <a href="https://www.mozilla.org/en-US/firefox/new/" target="ext">Firefox.</a>
                            </p>
                          </div>
                        </div>



                    </div><!-- /col-9 -->
                </div><!-- /padding -->
            </div>
            <!-- /main -->

        </div>
    </div>
</div>
	<!-- script references -->
		<script src="js/jquery-2.1.4.min.js"></script>

		<script src="js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>

<script>
function showInterestDiv() {
    if(document.getElementById('interestDiv').style.display == "block") {
        document.getElementById('interestDiv').style.display = "none";
        document.getElementById('interestBut').text = "Read more";
    } else {
        document.getElementById('interestDiv').style.display = "block";
        document.getElementById('interestBut').text = "Hide";
   }
}


</script>

<script>

var w = $("#forcegraph").innerWidth(),
    h = 600;
var r = 30*w/800;

var clicked = ["me","education","biology", "computing"];

var force = d3.layout.force()
    .charge(function(d){ return clicked.indexOf(d.src)>-1 ? -3000*r/30 : 0;})
    .linkStrength(0.2)
    .linkDistance(function(d) {return 50*r/30;})
    .size([w, h]);

var vis = d3.select("#forcegraph").append("svg:svg")
    .attr("width", w)
    .attr("height", h);

d3.csv("js/graph.csv", function(links) {
  var nodesByName = {};

  // Create nodes for each unique source and target.
  links.forEach(function(link) {
    link.target = nodeByNamePlus(link.target,link.im,link.size,link.source,link.desc);
    link.source = nodeByName(link.source);
  });

  // Extract the array of nodes from the map by name.
  var nodes = d3.values(nodesByName);

  // Create the link lines.
  var link = vis.selectAll(".link")
      .data(links)
    .enter().append("line")
      .attr("class", "link");

  // Create the node circles.
  var node = vis.selectAll(".node")
      .data(nodes)
    .enter().append("g")
      .attr("class", "node")
      .on("click",click)
      .call(force.drag);

  var clip = vis.append("defs").append("svg:clipPath")
        .attr("id", "clip")
        .append("svg:circle")
        .attr("id", "clip-rect")
        .attr("cx", 0)
        .attr("cy", 0)
        .attr("r", r)
        .attr("stroke","black");

  node.append("image")
    .attr("xlink:href", function(d) { return d.im ? d.im : "";})
    .attr("x",-r)
    .attr("y",-r)
    .attr("width", 2*r)
    .attr("height", 2*r)
    .attr("clip-path","url(#clip)")
    .attr("title",function(d) {return d.desc ? d.desc  : "";});

  node.append("text")
      .attr("dx", function(d) { return -d.name.length*3.5; })
      .attr("dy", r+10)
      .text(function(d) { return d.name });

  /*
  node.append("rect")
    .attr("class","node-rect")
    .style("opacity",function(d) { if(d.src=="me" && d.name!="me") {return 0.5;} else{return 0;}  })
    .attr("x", -r)
     .attr("y", -r)
      .attr("width", 2*r)
      .attr("height", 2*r);
      */

  // Start the force layout.
  force
      .nodes(nodes)
      .links(links)
      .on("tick", tick)
      .start();

  function tick() {

    node.style("opacity",function(d) {
        d.trans = 0;
        if(clicked.indexOf(d.src)>-1) d.trans = 1;
        return d.trans;
      });


    node.attr("transform", function(d) {
        d.x = Math.max(r, Math.min(w - 2*r, d.x));
        d.y = Math.max(h/2, Math.min(h - 2*r, d.y));
        if(d.src=="me") {
            d.y = h/4;
            d.x = Math.max(w/6, Math.min(5*w/6, d.x));
        }
        if(d.name=="me") d.y = h/8;
        return "translate(" + d.x + "," + d.y + ")";
      });

    link.style("opacity",function(d) { return Math.min(d.target.trans,d.source.trans);  });
    link.attr("x1", function(d) { return d.source.x; })
        .attr("y1", function(d) { return d.source.y; })
        .attr("x2", function(d) { return d.target.x; })
        .attr("y2", function(d) { return d.target.y; });

  }

  function click(d) {
  if (!d3.event.defaultPrevented) {
    var ind = clicked.indexOf(d.name);
    if(ind>0){
        clicked.splice(ind, 1)
    } else {
        clicked.push(d.name);
    }
    force.start();
    }
  }

  function nodeByName(name) {
    return nodesByName[name] || (nodesByName[name] = {name: name});
  }

  function nodeByNamePlus(name,im,size,src,desc) {
    return nodesByName[name] || (nodesByName[name] = {name: name, im: im, size: size, src: src, desc: desc});
  }
});

$( window ).resize(function() {
    w = $("#forcegraph").innerWidth();
    force.size([w, h ]);
    vis.attr("width", w);
});




</script>

    <script src='js/bubble.js'></script>
    <script src='js/lib_data.js'></script>
    <script src='js/lib_link.js'></script>
    <script src='js/lib_mouse.js'></script>
    <script src='js/lib_plot.js'></script>
    <script src='js/main.js'></script>

	</body>
</html>
